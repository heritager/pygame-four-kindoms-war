# 四国争霸 - 策略战争游戏

一个基于Pygame开发的回合制策略战争游戏，支持多人对战和单人AI对战模式。

## 游戏简介

四国争霸是一款经典的领土争夺策略游戏，四位玩家（或一位玩家和三位AI）在一个20x20的棋盘上争夺领土、占领城市、消灭对手。游戏包含丰富的地形系统、城市生产机制和智能AI对手。

## 游戏模式

### 1. 多人对战模式 (game.py)

四位玩家轮流操作，适合本地多人游戏。

**特点：**
- 四位玩家轮流行动
- 每轮结束后触发生产阶段
- 适合朋友聚会或本地对战

### 2. 单人AI对战模式 (Single_Game.py)

玩家1（红色）对战三个AI对手，适合单人挑战。

**特点：**
- 玩家控制红色方
- 三个AI对手自动行动
- AI采用智能评分系统决策
- 更具挑战性的单人体验

## 游戏规则

### 基本规则

1. **回合制**：每位玩家轮流行动，每回合有固定的行动点数
2. **行动点数**：
   - 第1-5轮：每回合3步
   - 第6-10轮：每回合6步
   - 第11轮起：每回合10步
3. **胜利条件**：占领敌方首都消灭对手，最后存活的玩家获胜

### 地形系统

游戏包含四种地形，每种地形有不同的移动规则：

| 地形 | 颜色 | 移动规则 |
|------|------|----------|
| 平原 | 灰蓝色 | 只能上下左右移动1格，消耗1行动点 |
| 森林 | 绿色 | 可向八个方向移动1格（包括斜向），消耗1行动点 |
| 山脉 | 灰色 | 只能上下左右移动，消耗2行动点 |
| 水域 | 蓝色 | 水域中可移动2格，登陆陆地限制1格，消耗1行动点 |

**特殊规则：**
- 陆地棋子可以进入水域（距离限制1格）
- 山脉移动消耗加倍
- 森林支持斜向移动

### 城市系统

城市分为三种类型，具有不同的生产能力：

| 城市类型 | 外观 | 每轮生产量 |
|----------|------|-------------|
| 小城市 | 小方形建筑 | +1士兵 |
| 大城市 | 中等方形建筑 | +2士兵 |
| 首都 | 大型建筑+金色屋顶 | +2士兵 |

**规则：**
- 城市每轮结束后自动生产士兵
- 士兵上限为99
- 占领敌方城市可获得生产能力
- 首都被占领则该玩家被淘汰

### 战斗规则

1. **攻击**：移动到敌方士兵位置触发战斗
2. **胜负判定**：
   - 攻击方血量 > 防守方血量：攻击方获胜，剩余血量为两者之差
   - 攻击方血量 < 防守方血量：防守方获胜，剩余血量为两者之差
   - 血量相等：同归于尽，双方都消失
3. **领土占领**：战斗胜利后占领该位置领土（水域除外）

### 领土系统

1. **包围占领**：无士兵的领土如果被完全包围，会自动归属于包围者
2. **领土颜色**：半透明覆盖显示领土归属
3. **领土计数**：实时显示各方领土数量

### 士兵规则

1. **移动限制**：每个士兵每回合最多移动3次
2. **移动次数显示**：士兵左上角显示当前移动次数（如"1/3"）
3. **血量显示**：士兵中心显示当前血量

## 操作说明

### 多人模式 (game.py)

- **鼠标左键**：点击选择士兵，点击目标位置移动
- **结束回合按钮**：主动结束当前回合
- **R键**：重新开始游戏
- **ESC键**：退出游戏

### 单人模式 (Single_Game.py)

- **鼠标左键**：点击选择士兵，点击目标位置移动
- **结束回合按钮**：主动结束当前回合
- **AI自动行动**：AI回合时自动执行移动
- **ESC键**：退出游戏

## AI系统

单人模式中的AI采用智能评分系统，综合考虑以下因素：

### 评分因素

1. **占领价值**
   - 首都：15倍基础分
   - 大城市：10倍基础分
   - 小城市：6倍基础分
   - 普通领土：2倍基础分

2. **地形价值**
   - 森林：1.5倍加分
   - 平原：1倍加分

3. **战斗评估**
   - 击败敌人获得高分
   - 防守成功获得中等分
   - 同归于尽获得基础分

4. **威胁评估**
   - 周围敌人越多，位置得分越低
   - 优先避免危险位置

5. **战略目标**
   - 接近敌方首都获得额外加分
   - 领土扩张获得加分

6. **防御考虑**
   - 保护首都附近领土
   - 避免首都被威胁

### AI行为特点

- 优先占领高价值目标
- 平衡进攻与防御
- 有一定的思考延迟，模拟真实玩家
- 根据局势动态调整策略

## 安装说明

### 环境要求

- Python 3.7+
- Pygame 2.0+
- NumPy 1.19+

### 安装步骤

1. 克隆或下载项目到本地
2. 安装依赖库：
   ```bash
   pip install -r requirements.txt
   ```
3. 运行游戏：
   ```bash
   # 多人模式
   python game.py
   
   # 单人模式
   python Single_Game.py
   ```

## 游戏截图

游戏包含精美的视觉效果：
- 动态水域波浪动画
- 详细的森林和山脉绘制
- 独特的城市建筑风格
- 清晰的领土颜色标识
- 直观的UI界面

## 游戏特性

### 视觉效果
- 精美的地形渲染
- 动态水域效果
- 半透明领土覆盖
- 城市建筑细节
- 士兵血量和移动次数显示

### 游戏机制
- 智能AI对手
- 领土包围系统
- 城市生产机制
- 多样化地形规则
- 回合制行动点系统

### 用户体验
- 实时游戏日志
- 领地数量统计
- 可移动范围高亮
- 选中状态提示
- 流畅的游戏节奏

## 开发说明

### 项目结构

```
.
├── game.py              # 多人对战模式
├── Single_Game.py       # 单人AI对战模式
├── README.md           # 项目文档
└── requirements.txt     # 依赖库列表
```

### 核心类

- `Game`: 游戏主类，管理游戏状态和逻辑
- `AIPlayer`: AI玩家类，实现智能决策系统

### 主要方法

- `move_soldier()`: 处理士兵移动和战斗
- `calculate_possible_moves()`: 计算可移动位置
- `calculate_territories()`: 计算领土归属
- `production_phase()`: 生产阶段处理
- `next_player()`: 切换到下一个玩家

## 技术栈

- **Python**: 主要编程语言
- **Pygame**: 游戏引擎和图形渲染
- **NumPy**: 数值计算和矩阵操作

## 许可证

本项目仅供学习和娱乐使用。

## 贡献

欢迎提出建议和改进意见！

## 更新日志

### v1.0.0
- 初始版本发布
- 支持多人对战模式
- 支持单人AI对战模式
- 完整的地形和城市系统
- 智能AI评分系统
- 领土包围机制

## 联系方式

如有问题或建议，欢迎通过GitHub Issues联系。

---

**祝游戏愉快！** 🎮
