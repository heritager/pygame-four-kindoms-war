# 四国争霸 - 回合制策略游戏

## 简介
《四国争霸》是一款本地多人（热座）回合制策略游戏，支持2-4名玩家在同一台电脑上轮流操作。玩家通过移动士兵、占领城市、扩张领土，最终占领所有对手的首都，成为唯一的胜利者。游戏包含多种地形、城市类型和战斗机制，策略丰富。

## 特性
- **4人本地轮流游戏**（红、蓝、黄、绿四国）
- **动态地形**：平原、森林、山脉、水域，影响移动和战斗
- **城市系统**：小型城市、大型城市、首都，每轮自动生产士兵
- **领土扩张**：通过包围无主土地自动获取领土
- **回合制步数**：每轮步数随轮数增加（前期3步，中期6步，后期10步）
- **战斗系统**：士兵血量对战，胜者存活，平局同归于尽
- **中文界面**（需要字体支持）

## 安装与运行

### 环境要求
- Python 3.6+
- 依赖库：`pygame`, `numpy`, `requests`（可选，用于下载中文字体）

### 安装依赖
```bash
pip install pygame numpy requests
```

### 运行游戏
将代码保存为 `main.py`，然后在终端执行：
```bash
python main.py
```

如果未安装 `requests`，游戏将跳过字体下载，使用系统默认字体（可能导致中文显示为方框）。

## 游戏规则

### 基础概念
- **玩家**：共4家，编号1~4，颜色分别为红、蓝、黄、绿。
- **棋盘**：20×20网格，每个格子有地形属性和归属。
- **士兵**：每个士兵有血量（显示在圆圈内），移动和战斗的基础单位。
- **城市**：中立或归属某玩家的建筑，每轮自动生产士兵。类型：
  - 小型城市：每轮+1兵力
  - 大型城市：每轮+2兵力
  - 首都：每轮+2兵力，被占领则玩家出局

### 回合流程
1. **开始回合**：当前玩家获得若干行动步数（取决于当前轮数），所有士兵移动次数重置。
2. **移动士兵**：玩家可消耗步数移动己方士兵。每个士兵每回合最多移动3次。
3. **结束回合**：点击“结束回合”按钮或耗尽步数后，自动切换到下一位玩家。
4. **轮次结束**：当玩家1再次开始回合时，一轮结束，触发**生产阶段**：
   - 所有归属玩家的城市生产士兵（小型+1，大型+2，首都+2）。
   - 计算领土包围：无主且无士兵的土地如果被单一玩家完全包围，则归该玩家所有。

### 移动规则
- 移动消耗步数取决于**起始地形**和**目标地形**：
  | 起始地形 | 移动限制 | 基础消耗 |
  |---|---|---|
  | 平原 | 上下左右1格 | 1步 |
  | 森林 | 周围8邻格1格 | 1步 |
  | 山脉 | 上下左右1格 | 2步 |
  | 水域 | 水域内2格（斜向亦可），登陆仅限1格 | 1步 |
- 目标地形为山脉时，额外增加消耗（变为2步，但已包含在上述规则中）。
- 不能移动到己方其他士兵所在格（除非战斗）。

### 战斗规则
- 当士兵移动到敌方士兵所在格时，发生战斗。
- 比较双方当前血量：
  - 若攻击方血量 > 防守方：防守方被消灭，攻击方血量减去防守方血量后存活。
  - 若攻击方血量 < 防守方：攻击方被消灭，防守方血量减去攻击方血量后存活。
  - 若相等：双方同归于尽，格子变为无主（城市保留）。
- 战斗后，若攻击方存活，则占领该格子（包括城市），城市归属变为攻击方。

### 胜利条件
- 占领所有其他玩家的**首都**。当一位玩家的首都被占时，该玩家所有领土和士兵消失。
- 最后存活的玩家获胜。

## 操作说明
- **鼠标左键**：
  - 点击己方士兵（圆圈）选择它，可移动范围将用绿色边框高亮。
  - 点击高亮范围内的格子，移动选中的士兵到该位置。
  - 点击棋盘其他位置取消选择。
- **按钮**：
  - 点击右下角 **“结束回合”** 按钮主动结束当前玩家回合。
- **快捷键**：
  - `R`：重新开始游戏。
  - `ESC`：退出游戏。

## 界面元素
- **顶部信息栏**：显示当前玩家、轮数、剩余步数。
- **左侧日志区**：显示最近4条游戏事件记录。
- **右侧领地统计**：各玩家的领土数量（彩色方块）。
- **士兵**：彩色圆圈内显示当前血量，左上角显示本回合已移动次数（如“2/3”）。
- **城市**：不同样式的建筑图标，首都带金色边框。
- **地形**：颜色和纹理区分平原、森林、山脉、水域。

## 许可证
本项目供学习和娱乐，代码可自由修改和分发。

---

**Enjoy the game!** 🎮

---
